# 食品添加物風險評分系統 - 測試指南

## 🧪 如何測試新功能

### 測試場景 1: 健康產品（無添加物）
**測試產品**: 天然果汁、新鮮水果、純淨水

**預期結果**:
- ✅ 顯示綠色「未檢測到有害添加物」卡片
- 健康分數不會被扣分
- 分數透明度指示器不顯示（因為無扣分）

---

### 測試場景 2: 含低風險添加物的產品
**測試產品**: 餅乾、麵包、一般零食

**常見低風險添加物**:
- 檸檬酸 (E330)
- 小蘇打 (E500)
- 卵磷脂 (E322)
- 維生素C (E300)

**預期結果**:
- 顯示添加物分析卡片
- 總扣分: 1-10 分
- 可能仍保持綠色或黃色等級
- 分數透明度指示器顯示小幅調整

**測試方法**:
1. 掃描餅乾背面的成分表
2. 確保標籤清晰可見
3. 查看 ResultScreen 中的「食品添加物分析」卡片
4. 點擊「低風險添加物」展開查看詳情

---

### 測試場景 3: 含中風險添加物的產品
**測試產品**: 調味料、醬料、零卡飲料

**常見中風險添加物**:
- 味精/谷氨酸鈉 (E621)
- 磷酸鹽 (E338-E452)
- 山梨酸鉀 (E202)
- 阿斯巴甜 (E951)
- 二氧化硫 (E220)

**預期結果**:
- 總扣分: 5-20 分
- 健康分數明顯下降
- 可能從綠色降到黃色
- 清楚顯示「中風險添加物」分組

**測試方法**:
1. 掃描零卡可樂或調味料
2. 檢查是否檢測到阿斯巴甜或磷酸鹽
3. 確認扣分計算正確
4. 查看成分列表中的「添加物」黃色徽章

---

### 測試場景 4: 含高風險添加物的產品（🔥 關鍵測試）
**測試產品**: 加工肉品（火腿、香腸）、某些糖果、即食麵

**常見高風險添加物**:
- 亞硝酸鈉/鉀 (E249-E250) - 🔴 扣 30 分
- 紅色40號 (E129) - 🔴 扣 20 分
- 黃色5號 (E102) - 🔴 扣 20 分
- 苯甲酸鈉 (E211) - 🔴 扣 25 分

**預期結果**:
- 總扣分: 20-60 分（甚至更高）
- 健康分數大幅下降
- 可能降至紅色高風險等級
- 清楚顯示「高風險添加物」並置頂
- 摘要文字會附加「（因添加物調整評分 -XX分）」

**測試方法**:
1. 掃描火腿或香腸的成分表
2. 尋找「亞硝酸鈉」或「E250」
3. 確認健康分數被大幅扣分
4. 檢查：
   - 原始分數 vs 調整後分數顯示正確
   - 「高風險添加物」分組在最上面
   - 紅色徽章正確顯示
   - 成分列表中該項有紅色「添加物」標籤

---

## 📋 完整測試檢查清單

### UI 測試
- [ ] 添加物分析卡片正確顯示
- [ ] 高/中/低風險添加物分組清楚
- [ ] 展開/收合動畫流暢
- [ ] 每個添加物顯示：名稱、E編號、類別、扣分、說明
- [ ] 分數透明度指示器正確顯示原始分數和調整後分數
- [ ] 成分列表中的「添加物」徽章顏色正確
- [ ] 無添加物時顯示綠色通過標誌

### 功能測試
- [ ] 多語言匹配（中文、英文、E編號都能檢測）
- [ ] 去重功能（同一添加物不會重複扣分）
- [ ] 扣分上限（最多扣 100 分，不會出現負分）
- [ ] 風險等級重新評估（扣分後正確更新綠/黃/紅）
- [ ] AI prompt 增強（更準確識別添加物）

### 邊緣情況測試
- [ ] 掃描完全天然產品（0 個添加物）
- [ ] 掃描極不健康產品（10+ 個高風險添加物）
- [ ] 掃描模糊照片（添加物可能檢測不完整）
- [ ] 掃描外文標籤（英文成分名稱）
- [ ] 快速連續掃描多個產品

---

## 🐛 已知限制

1. **依賴 AI OCR 準確度**
   - 如果 AI 沒有正確識別成分名稱，添加物檢測也會失敗
   - 解決方案：照片清晰、光線充足

2. **資料庫覆蓋率**
   - 目前包含 40+ 種常見添加物
   - 未來可擴展至更多添加物

3. **模糊匹配限制**
   - 某些複雜化學名稱可能匹配失敗
   - 解決方案：持續完善關鍵字列表

---

## 🎯 成功標準

測試通過條件：
1. ✅ 能檢測到至少 80% 的常見添加物
2. ✅ 扣分邏輯準確（無重複扣分）
3. ✅ UI 清晰易懂，無佈局錯誤
4. ✅ 無 app 崩潰或性能問題
5. ✅ 用戶能理解為什麼分數被調整

---

## 📸 推薦測試產品清單

### 高風險產品（預期大幅扣分）
- 🥓 火腿、培根、香腸（亞硝酸鈉）
- 🍬 彩色糖果（人工色素）
- 🥤 部分汽水（苯甲酸鈉）

### 中風險產品（預期中等扣分）
- 🧂 調味料（味精）
- 🥤 零卡飲料（人工甜味劑）
- 🧀 加工起司（磷酸鹽）

### 低風險產品（預期少量扣分）
- 🍪 一般餅乾（檸檬酸、卵磷脂）
- 🍞 麵包（小蘇打）
- 🧃 果汁飲料（維生素C）

### 無風險產品（預期不扣分）
- 🍎 新鮮水果
- 💧 純淨水
- 🥛 純牛奶（無添加）

---

**測試日期**: _________  
**測試者**: _________  
**測試版本**: 1.0.0  
**測試狀態**: ⏳ 待測試
