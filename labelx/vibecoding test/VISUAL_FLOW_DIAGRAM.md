# è¦–è¦ºåˆ†ææµç¨‹åœ–

## å®Œæ•´æ¶æ§‹æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ä½¿ç”¨è€…æ‹æ”é£Ÿå“æ¨™ç±¤                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              CameraScreen.takePicture()                         â”‚
â”‚              - æ‹ç…§æˆ–é¸æ“‡åœ–ç‰‡                                    â”‚
â”‚              - å„²å­˜åˆ°æœ¬åœ°                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           analyzeFoodLabel(imageUri)                            â”‚
â”‚           ä½ç½®: src/api/food-analysis.ts                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         FileSystem.readAsStringAsync()                          â”‚
â”‚         - è®€å–åœ–ç‰‡æª”æ¡ˆ                                           â”‚
â”‚         - è½‰æ›ç‚º Base64 ç·¨ç¢¼                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
         â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
         â•‘   ã€éšæ®µ 1ã€‘OCR æ–‡å­—æå–              â•‘
         â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                         â”‚
                         â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  å˜—è©¦ Google Cloud Vision API  â”‚
         â”‚  detectTextWithVision()       â”‚
         â”‚  ä½ç½®: src/api/google-vision.tsâ”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                       â”‚
    ã€æˆåŠŸã€‘                 ã€å¤±æ•—ã€‘
         â”‚                       â”‚
         â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ OCR æˆåŠŸ        â”‚    â”‚ è§¸ç™¼é™ç´šæ©Ÿåˆ¶          â”‚
â”‚ - æå–å®Œæ•´æ–‡å­—   â”‚    â”‚ - è¨˜éŒ„éŒ¯èª¤åŸå›         â”‚
â”‚ - æª¢æ¸¬èªè¨€      â”‚    â”‚ - Console è­¦å‘Š        â”‚
â”‚ - è¨ˆç®—ä¿¡å¿ƒåº¦    â”‚    â”‚ - åˆ‡æ›è‡³å‚™ç”¨æ–¹æ¡ˆ      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                       â”‚
         â”‚                       â”‚
         â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ocrResult =     â”‚    â”‚ ocrResult = null     â”‚
â”‚ {               â”‚    â”‚ ocrMethod =          â”‚
â”‚   fullText,     â”‚    â”‚   "openai-vision"    â”‚
â”‚   languages,    â”‚    â”‚                      â”‚
â”‚   confidence    â”‚    â”‚                      â”‚
â”‚ }               â”‚    â”‚                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                       â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
         â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
         â•‘   ã€éšæ®µ 2ã€‘æˆåˆ†åˆ†æ                   â•‘
         â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                     â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                       â”‚
  ã€é¦–é¸æ–¹æ³•ã€‘             ã€é™ç´šæ–¹æ³•ã€‘
         â”‚                       â”‚
         â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ analyzeExtractedTextâ”‚  â”‚ analyzeImageWithVision â”‚
â”‚ - ä½¿ç”¨ OCR æ–‡å­—     â”‚  â”‚ - ç›´æ¥åˆ†æåœ–ç‰‡          â”‚
â”‚ - GPT-4o æ–‡å­—åˆ†æ   â”‚  â”‚ - GPT-4o Vision åˆ†æ   â”‚
â”‚ - è­˜åˆ¥æˆåˆ†åˆ—è¡¨      â”‚  â”‚ - OCR + æˆåˆ†è­˜åˆ¥        â”‚
â”‚ - å®¹éŒ¯ OCR éŒ¯åˆ¥å­—   â”‚  â”‚ - åŸæœ‰æ–¹æ³•             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚                       â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚  parseAnalysisResponse   â”‚
           â”‚  - è§£æ JSON å›æ‡‰        â”‚
           â”‚  - æå–æˆåˆ†è³‡æ–™          â”‚
           â”‚  - éŒ¯èª¤è™•ç†             â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚  analysisData =         â”‚
           â”‚  {                      â”‚
           â”‚    healthScore,         â”‚
           â”‚    safeIngredients,     â”‚
           â”‚    warningIngredients,  â”‚
           â”‚    nutritionData        â”‚
           â”‚  }                      â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
         â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
         â•‘   ã€éšæ®µ 3ã€‘æ·»åŠ åŠ‘æª¢æ¸¬èˆ‡è©•åˆ†èª¿æ•´        â•‘
         â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                       â”‚
                       â–¼
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚  detectAdditives()      â”‚
           â”‚  - å¾æˆåˆ†ä¸­æª¢æ¸¬æ·»åŠ ç‰©    â”‚
           â”‚  - åŒ¹é…æ·»åŠ ç‰©è³‡æ–™åº«      â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚ calculateAdditiveDeductionâ”‚
           â”‚ - è¨ˆç®—æ‰£åˆ†              â”‚
           â”‚ - èª¿æ•´å¥åº·åˆ†æ•¸          â”‚
           â”‚ - æ›´æ–°é¢¨éšªç­‰ç´š          â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚  çµ„è£æœ€çµ‚çµæœ            â”‚
           â”‚  FoodAnalysisResult      â”‚
           â”‚  {                      â”‚
           â”‚    id, imageUri,        â”‚
           â”‚    healthScore,         â”‚
           â”‚    riskLevel,           â”‚
           â”‚    ingredients,         â”‚
           â”‚    additiveAnalysis     â”‚
           â”‚  }                      â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              è¿”å›çµæœåˆ° CameraScreen                             â”‚
â”‚              - é¡¯ç¤ºå¥åº·è©•åˆ†                                      â”‚
â”‚              - é¡¯ç¤ºæˆåˆ†åˆ†æ                                      â”‚
â”‚              - å°èˆªåˆ° ResultScreen                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## é—œéµæ±ºç­–é»

### æ±ºç­–é» 1: OCR æ–¹æ³•é¸æ“‡

```
Google Vision API æ˜¯å¦æˆåŠŸï¼Ÿ
â”‚
â”œâ”€ âœ… æ˜¯ â†’ ä½¿ç”¨æå–çš„æ–‡å­—ï¼ˆé¦–é¸æ–¹æ³•ï¼‰
â”‚          - æ›´å¿«é€Ÿï¼ˆ2-5ç§’ï¼‰
â”‚          - æ›´æº–ç¢ºï¼ˆ95-98%ï¼‰
â”‚          - æˆæœ¬æ›´ä½
â”‚
â””â”€ âŒ å¦ â†’ é™ç´šè‡³ OpenAI Visionï¼ˆå‚™ç”¨æ–¹æ¡ˆï¼‰
           - ä»èƒ½å®Œæˆåˆ†æ
           - æº–ç¢ºåº¦ç•¥é™ï¼ˆ85-90%ï¼‰
           - ç¢ºä¿æœå‹™å¯ç”¨æ€§
```

### æ±ºç­–é» 2: åˆ†ææ–¹æ³•é¸æ“‡

```
æ˜¯å¦æœ‰ OCR çµæœï¼Ÿ
â”‚
â”œâ”€ âœ… æ˜¯ â†’ analyzeExtractedText()
â”‚          - åƒ…åˆ†ææ–‡å­—å…§å®¹
â”‚          - å°ˆæ³¨æ–¼æˆåˆ†è­˜åˆ¥
â”‚          - è™•ç†é€Ÿåº¦æ›´å¿«
â”‚
â””â”€ âŒ å¦ â†’ analyzeImageWithVision()
           - åœ–ç‰‡ç›´æ¥åˆ†æ
           - OCR + åˆ†æä¸€æ¬¡å®Œæˆ
           - åŸæœ‰æ–¹æ³•ï¼Œå·²é©—è­‰
```

---

## æ•ˆèƒ½æ™‚é–“ç·š

```
æ™‚é–“è»¸ (ç§’)
0s â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> 15s
â”‚
â”œâ”€ 0-1s: è®€å–åœ–ç‰‡ä¸¦è½‰æ›ç‚º Base64
â”‚       â–“
â”‚
â”œâ”€ 1-6s: Google Vision API OCR
â”‚       â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–“
â”‚       â”‚
â”‚       â””â”€ å¦‚æœå¤±æ•—ï¼Œç«‹å³åˆ‡æ›è‡³é™ç´šæ–¹æ¡ˆ
â”‚
â”œâ”€ 6-14s: OpenAI æ–‡å­—åˆ†æ
â”‚         â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–“
â”‚
â”œâ”€ 14-15s: æ·»åŠ åŠ‘æª¢æ¸¬èˆ‡è©•åˆ†èª¿æ•´
â”‚           â–‘â–“
â”‚
â””â”€ 15s: è¿”å›çµæœ
        â”‚

ã€é¦–é¸è·¯å¾‘ã€‘ç¸½æ™‚é–“: 5-12 ç§’ âš¡
ã€é™ç´šè·¯å¾‘ã€‘ç¸½æ™‚é–“: 8-15 ç§’ ğŸ”„
```

---

## è³‡æ–™æµè½‰

```
Image File (imageUri)
    â”‚
    â–¼
Base64 String
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Google Vision API Request       â”‚
â”‚ {                               â”‚
â”‚   image: { content: base64 },   â”‚
â”‚   features: ["TEXT_DETECTION"]  â”‚
â”‚ }                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Vision API Response             â”‚
â”‚ {                               â”‚
â”‚   textAnnotations: [            â”‚
â”‚     { description: "æˆåˆ†ï¼š..." }â”‚
â”‚   ]                             â”‚
â”‚ }                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ OCRResult                       â”‚
â”‚ {                               â”‚
â”‚   fullText: "æˆåˆ†ï¼šæ°´ã€ç³–...",   â”‚
â”‚   detectedLanguages: ["zh"],    â”‚
â”‚   confidence: "high"            â”‚
â”‚ }                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ OpenAI Analysis Request         â”‚
â”‚ {                               â”‚
â”‚   messages: [                   â”‚
â”‚     { role: "user",             â”‚
â”‚       content: "åˆ†æä»¥ä¸‹æˆåˆ†..." }â”‚
â”‚   ]                             â”‚
â”‚ }                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Analysis Response (JSON)        â”‚
â”‚ {                               â”‚
â”‚   healthScore: 75,              â”‚
â”‚   safeIngredients: [...],       â”‚
â”‚   warningIngredients: [...]     â”‚
â”‚ }                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Additive Detection              â”‚
â”‚ - æª¢æ¸¬æ·»åŠ ç‰©                    â”‚
â”‚ - è¨ˆç®—æ‰£åˆ†                      â”‚
â”‚ - èª¿æ•´è©•åˆ†                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FoodAnalysisResult              â”‚
â”‚ {                               â”‚
â”‚   healthScore: 65,              â”‚
â”‚   riskLevel: "medium",          â”‚
â”‚   ingredients: { safe, warning },â”‚
â”‚   additiveAnalysis: {...}       â”‚
â”‚ }                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## éŒ¯èª¤è™•ç†æµç¨‹

```
ä»»ä½•éšæ®µç™¼ç”ŸéŒ¯èª¤
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ éŒ¯èª¤é¡å‹åˆ¤æ–·              â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”œâ”€ Vision API éŒ¯èª¤
       â”‚   â”‚
       â”‚   â”œâ”€ ç¶²è·¯éŒ¯èª¤ â†’ é™ç´šè‡³ OpenAI Vision
       â”‚   â”œâ”€ è¶…æ™‚éŒ¯èª¤ â†’ é™ç´šè‡³ OpenAI Vision
       â”‚   â”œâ”€ API Key éŒ¯èª¤ â†’ é™ç´šè‡³ OpenAI Vision
       â”‚   â””â”€ ç„¡æ–‡å­—æª¢æ¸¬ â†’ æç¤ºä½¿ç”¨è€…é‡æ‹
       â”‚
       â”œâ”€ OpenAI éŒ¯èª¤
       â”‚   â”‚
       â”‚   â”œâ”€ JSON è§£æå¤±æ•— â†’ è¿”å›é è¨­åˆ†æçµæœ
       â”‚   â”œâ”€ API éŒ¯èª¤ â†’ æ‹‹å‡ºéŒ¯èª¤ï¼Œé¡¯ç¤ºæç¤º
       â”‚   â””â”€ è¶…æ™‚éŒ¯èª¤ â†’ æ‹‹å‡ºéŒ¯èª¤ï¼Œé¡¯ç¤ºæç¤º
       â”‚
       â””â”€ å…¶ä»–éŒ¯èª¤
           â””â”€ æ‹‹å‡ºé€šç”¨éŒ¯èª¤ â†’ "åˆ†æå¤±æ•—ï¼Œè«‹é‡è©¦"
```

---

## Console æ—¥èªŒç¯„ä¾‹

### æˆåŠŸæ¡ˆä¾‹ï¼ˆGoogle Visionï¼‰

```
=== Starting Food Label Analysis ===
Image size: 123456 characters
[OCR] Attempting Google Cloud Vision API...
[Google Vision] Starting OCR request...
[Google Vision] OCR completed in 3245ms
[Google Vision] Detected 42 words in languages: ["zh", "en"]
[OCR] Google Vision succeeded in 3245ms
[OCR] Detected languages: ["zh", "en"]
[OCR] Word count: 42
[OCR] Confidence: high
[OCR] Text preview: æˆåˆ†ï¼šæ°´ã€ç³–ã€æª¸æª¬é…¸(E330)ã€å±±æ¢¨é…¸é‰€(E202)...
[Analysis] Analyzing extracted text with OpenAI...
[Parse] AI Response Length: 1234
[Parse] Safe Ingredients: 5
[Parse] Warning Ingredients: 3
[Analysis] Completed in 5120ms
[Total] Processing took 8365ms
[Method] OCR: google-vision
=== Analysis Complete ===
```

### é™ç´šæ¡ˆä¾‹ï¼ˆOpenAI Visionï¼‰

```
=== Starting Food Label Analysis ===
Image size: 123456 characters
[OCR] Attempting Google Cloud Vision API...
[Google Vision] Starting OCR request...
[Google Vision] OCR failed: ç¶²è·¯éŒ¯èª¤
[OCR] Google Vision failed: OCRå¤±æ•—: ç¶²è·¯éŒ¯èª¤
[OCR] Falling back to OpenAI vision analysis...
[Analysis] Using OpenAI vision to analyze image directly...
[Parse] AI Response Length: 1234
[Parse] Safe Ingredients: 5
[Parse] Warning Ingredients: 3
[Analysis] Completed in 8500ms
[Total] Processing took 8500ms
[Method] OCR: openai-vision
=== Analysis Complete ===
```

---

## æª”æ¡ˆå°æ‡‰è¡¨

| åŠŸèƒ½æ¨¡çµ„ | æª”æ¡ˆä½ç½® | è¡Œæ•¸ |
|---------|---------|------|
| **Vision API æœå‹™** | `src/api/google-vision.ts` | 247 |
| **é¡å‹å®šç¾©** | `src/types/vision.ts` | 120 |
| **é£Ÿå“åˆ†æï¼ˆä¸»æµç¨‹ï¼‰** | `src/api/food-analysis.ts` | 414 |
| **ç›¸æ©Ÿç•«é¢** | `src/screens/CameraScreen.tsx` | 664 |
| **çµæœé¡¯ç¤º** | `src/screens/ResultScreen.tsx` | ç¾æœ‰ |
| **æ·»åŠ ç‰©æª¢æ¸¬** | `src/utils/additiveDetection.ts` | ç¾æœ‰ |
| **æ•´åˆæ–‡ä»¶** | `GOOGLE_VISION_INTEGRATION.md` | 600+ |

---

## API ç«¯é»

### Google Cloud Vision API

```
ç«¯é»: https://vision.googleapis.com/v1/images:annotate
æ–¹æ³•: POST
èªè­‰: API Key (Query Parameter)
è¶…æ™‚: 15 ç§’
è«‹æ±‚æ ¼å¼: JSON
å›æ‡‰æ ¼å¼: JSON
```

### OpenAI GPT-4o

```
ç«¯é»: https://api.openai.com/v1/chat/completions
æ–¹æ³•: POST
èªè­‰: Bearer Token (Header)
è¶…æ™‚: 30 ç§’ï¼ˆé è¨­ï¼‰
æ¨¡å‹: gpt-4o-2024-11-20
è«‹æ±‚æ ¼å¼: JSON
å›æ‡‰æ ¼å¼: JSON
```

---

é€™å€‹æµç¨‹åœ–æ‡‰è©²èƒ½å¹«åŠ©æ‚¨æ¸…æ¥šäº†è§£æ•´å€‹è¦–è¦ºåˆ†æç³»çµ±çš„æ¶æ§‹ï¼ ğŸ¯
